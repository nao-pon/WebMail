WebMail2 1.02(J1.5) by nao-pon http://hypweb.net

XOOPS用のモジュール WebMail は pop3 クライアントです。
ブラウザを使用してどこからでも、メールの送受信ができます。

>> インストール方法:

1. WebMail_J1_5.zip を解凍します。
2. WebMail/cache/にある config.php.empty を config.php にリネームします。
3. XOOPSのモジュールディレクトリにコピー(アップロード)します。
4. XOOPS管理者画面よりインストールしてください。
5. パーミッションを設定します。
   "cache", "tmp", "atachments" の各ディレクトリは 777
   "config.php" は 777 または 766 にしてください。


>> アップデート方法

1. WebMail_J1_5.zip を解凍します。
2. XOOPSのモジュールディレクトリにコピー(アップロード)します。
3. WebMail2 1.02(J)1.2 以前よりアップデートした場合は、WebMailの管理者画面より「データベーステーブルのアップデート実行」ボタンをクリックして、データベースのアップデートを行ってください。
4. WebMailの管理者画面の設定項目が増えていますので、設定値を確認してください。


WebMail2 のオリジナル版は、 Jochen Gererstorfer さんが http://gererstorfe.net で配布しています。
そのオリジナル版に対して nao-pon が日本語化＋機能強化 を施しました。

サポート・配布は、http://hypweb.net/ でおこなってます。
ただし、このプログラムを使用したことによって生じた損害・不利益等に対して、一切責任は負いかねますので、すべては、自己責任においてご利用ください。


●　更新履歴
WebMail 1.02(J1.5) 2004/4/26
・register_globals = off の環境でも動くように修正。 
・メール表示画面上部の [ Next > ]リンク表示を次のメッセージがない場合は、表示しないようにした。 
・送信を許可していない場合にメールを閲覧するとJavaScript?エラーになっていたのを修正。 
・送信メール作成画面で、「すべてクリア」ボタンをクリックしても、添付ファイルがクリアされない問題を修正。 
・送信メール作成画面に、「添付ファイル クリア」ボタンを新設。 
・署名の挿入機能を追加。 
・ヘッダの文字構成によって、表示できないメールがあったので、ヘッダのパラメーター抽出を、大文字・小文字関係なく行うようにした。
・受信トレイでメール一覧を表示するのに、メールを15行分だけ取得するようにして、高速化してみた。
・settings.php内に"action='settings'"となっている部分があったので、"action='settings.php'"に修正した。
・アドレス帳でページ移動ができない不具合を修正

WebMail 1.02(J1.4) 2003/5/1
・送信時の件名・送信者名の日本文字化け対策をしてみた。 
・XOOPS 2 で管理者画面の一般設定を保存した時に、次に表示されるページが Not Found. になる問題を修正。（元の画面に戻るようにしました。） 
・mailattach.php に存在したセキュリティの脆弱性を修正した。J1.4b0以前のバージョンは使用しないで下さい。 

WebMail 1.02(J1.3) 2003/4/10

・相手先のPOPサーバーの状態によりWebMailのトップページの一覧表示に時間がかかることがあるので、初期状態では一覧表示なしで、WebMailのメニューバーにアカウントのドロップダウンリストを表示するようにした。 
・readmail.php,inbox.php で文字化け対策でテスト的にmb_string の iniを設定するようにしてみた。ただ、効果はないかもしれない？ 
・mb_ereg系が使えないサーバで、動作しない不具合を暫定修正。 
・メール表示画面で "< Pre" "Next >" をクリックで移動できるようにした。 
・APOP認証に対応。 
・データベーステーブルのアップデートを管理者画面から簡単に行えるようにした。 
・ユーザーがメールアカウントごとに送信アドレスを設定して、送信時に選択できるようにした。 
・管理者画面の設定項目追加 
　（メール送信を許可する場合、アカウント別のメールアドレスでの送信を許可しますか？） 
・メール送信時、送信アドレス宛てにBCCでコピーを送信するようにした。 
・文字コードの判別に失敗して文字化けすることがあったのを若干修正した。 
・HTMLメールが文字化けすることがあったのを修正した。(まだ完璧ではないと思う) 
・一覧表示において、MINE(B)エンコードで改行を挟んでいいるメールの Subject または From が途中で切れていたのを修正した。 
・受信HTMLメールの背景色(画)とHTML埋め込みの画像に対応。 
・一覧表示で添付ファイルがある場合のクリップ画像が表示されていなかった問題を修正。 
・一覧表示でHTMLメールには、HTMLマークを表示するようにした。 
・一覧表示で、Subjectにマウスカーソルを当てるとメール本文(抜粋)を表示するようにした。ただし、title属性なのでブラウザに依存します。 
・一覧表示で、Fromにマウスカーソルを当てた時に表示されるヒントテキストを若干改良した。 
・受信HTMLメールでQuoted Printableエンコードしていないメールもデコードしていたので、必要の場合のみデコードするようにした。=>文字化け対策。 
・受信HTMLメールで、タグの途中で改行されている場合、正しく表示できない事があった問題を修正。 
・送信時に先頭に空行が１行付加される問題を修正。 
・受信メールの表示で先頭に空行が１行余分に表示される問題を修正。 
・サーバー環境により送信メールの To, Subject などのMINEエンコードが "ISO-2022-JP"にならない場合がある問題の対策として、パラメータを与えてみた。->解決するかどうかは不明。 
・To,Cc,Bcc に複数宛先を指定する場合に、"日本語の名前 <hoge@hoge.com>,日本語の名前２ <hoge2@hoge.com>" というように指定できるように対策をした。(今までは , で区切って複数入力した時に日本語が正しくエンコードされていなかった。) 
・受信HTMLメールの表示を最初はHTMLを無効にして表示するようにした。 
・一覧表示で[HTML]マークをクリックすることで、HTMLを有効にして表示するようにした。 
・HTMLメールの場合メール表示画面にHTMLソースを表示できるリンクを追加した。 
・HTMLメールで背景画像が指定されている場合、本文の領域を最低でもその背景画像の大きさの分だけ表示するようにした。(背景画像をすべて表示できるようにするため) 
・Quoted PrintableエンコードのHTMLメールを複数回デコードしてしまうことがあり、その場合文字化けしていたので修正した。 
・HTMLメールの表示で、テキスト・HTML有効 どちらの場合も Script はタグとともに色付で表示するようにした。(Scriptは実行されません。) 
・HTMLメールでHTMLソースを表示した時、タグは色付で表示するようにした。 
・管理者画面の「転送時にヘッダ情報をフィルタリングする。」の項目が実際は何も機能していなかったので、「メールの返信・転送時に本文にヘッダ情報を付加しますか？」という項目に変えて、機能するようにした。 


WebMail 1.02 (J1.2)　2003/2/17

・POPセッションで、QUITを発行せずに、切断していたところがあったので修正。
・POPセッションで、QUIT発行後、応答を待たずに切断していたので、応答を待って切断するようした。
・一覧表示の取得時に、一覧件数を多くすると、遅いPOPサーバーの場合タイムアウトすることが合ったので、とりあえずタイムアウトを120秒にしてみた。 
・送信メールの添付ファイル名に日本語を使えるようにしてみた。
・送信時も複数添付ファイルに対応した。 
・ファイル添付の処理方法を変更。
　　.cgi .php の拡張子のファイルでも安全に取り扱えるようになった。(多分)
・一時的に保存するファイル名を一意のファイル名にして、同一ファイル名が重なった時の問題に対応。
・管理画面で、一時ファイルを保持する時間を設定して、その時間が過ぎたファイルは、削除するようにした。　　削除するタイミングは、WebMailのindex.php を誰かが開いた時。
　　また、送信添付ファイルは送信終了後に、自動削除するようにした。
・複数宛先の最大件数と添付ファイルの一時ファイルの有効時間を設定できるようにした。
・HTMLメールで文字化けすることがあったのを修正。
・HTMLメールを返信・転送すると引用文にHTMLソースがそのまま表示されていたのを修正。
　　ただし、その処理にJavaScriptを使用しています。
・HTMLメールの余分なタグを取り除くようにした。(完璧ではない)
　　<HEAD>〜</HEAD>,<HTML>,</HTML>など
・本文にヘッダと同じ記述が含まれている場合に、受信トレイ(メール一覧表示)で間違って本文に記述されているものをヘッダとして取得していたのを修正した。
・From,To,Subjectが MINEエンコードされていないメールを受け取った時に、受信トレイとメール表示画面で文字化けすることがあったのを修正した。
・「未承諾広告」「連絡方法無し」などが、Subject に含まれる場合に削除対象のチェックボックスをONにする機能を追加した。
　　（管理者画面で、対象文字列を設定できます。）
・その他、細かいバグ取り。


WebMail2 1.02(J1.1) 2003/2/5

・一部の MTA でメール送信ができなかった不具合を修正。
・複数のPOPアカウントを設定している場合に、接続エラーがあると、
　その次以降ののPOPアカウントへの接続が行われない問題を修正。
・受信トレイ一覧画面の送信者が一部文字化けすることがあったのを修正。
・受信メール表示画面で、宛先が文字化けしていたのを修正。
・送信時にファイルを添付できるように修正してみた。(暫定)
・受信添付ファイルの日本語ファイル名に対応。
